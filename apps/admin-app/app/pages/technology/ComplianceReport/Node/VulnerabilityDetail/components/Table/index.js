import { useTranslation } from 'react-i18next';

import { useState } from 'react';
import { useSelector } from 'react-redux';

import { vulnerabilitiesSelector } from '../../redux/selectors';
import AntTableV2 from '@shared/components/UI/AntTableV2';
import { tableColumns } from './config';

const INITIAL_PAGINATION = { currentPage: 1, rowsPerPage: 50 };

const Table = () => {
  const { t } = useTranslation('technologyComplianceReport');

  const [pagination, setPagination] = useState(INITIAL_PAGINATION);

  const handlePaginationChange = ({ currentPage, rowsPerPage }) => {
    if (currentPage !== pagination.currentPage || rowsPerPage !== pagination.rowsPerPage) {
      setPagination({ currentPage, rowsPerPage });
    }
  };

  const vulnerabilities = useSelector(vulnerabilitiesSelector.getData);
  const vulnerabilitiesPending = useSelector(vulnerabilitiesSelector.isPending);

  return (
    <AntTableV2
      loading={vulnerabilitiesPending}
      data={vulnerabilities.slice((pagination.currentPage - 1) * pagination.rowsPerPage, pagination.currentPage * pagination.rowsPerPage)}
      total={vulnerabilities.length}
      columns={tableColumns({ t })}
      pagination={pagination}
      onPaginationChange={handlePaginationChange}
    />
  );
};

export default Table;
